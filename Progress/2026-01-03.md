---
date: 2026-01-03
phase: 2
topic: Web Security
tags: [security, web, owasp, learning]
---

# 2026-01-03: Web Security Basics

## 学習トピック

### 1. SQLインジェクション
- ユーザー入力がSQLコードとして実行される
- 対策: パラメータ化クエリ（データとコードの構造的分離）

### 2. XSS（Cross-Site Scripting）
- ユーザー入力がブラウザでJavaScriptとして実行される
- 対策: 出力時のコンテキスト別エスケープ
- 入力時は検証、出力時はエスケープ

### 3. IDOR（Insecure Direct Object Reference）
- 認証と認可の違い
  - 認証: あなたは誰か
  - 認可: あなたは何ができるか
- URLのIDを変えるだけで他人のデータにアクセス
- 対策: リソースの所有者確認

### 4. CSRF（Cross-Site Request Forgery）
- 被害者のブラウザを経由した不正リクエスト
- ブラウザがCookieを自動送信する仕様を悪用
- 対策: CSRFトークンで「自サイト発か」を確認

### 5. SSRF（Server-Side Request Forgery）
- サーバーを踏み台にして内部ネットワークにアクセス
- 169.254.169.254（クラウドメタデータ）への攻撃
- Capital One事件（2019年、1億人分の情報漏洩）
- 対策: URL検証、内部IPのブロック、許可リスト

### 6. 暗号化の失敗（Cryptographic Failures）
- 平文保存、弱いハッシュ（MD5/SHA1）の危険性
- 正しいパスワード保存: bcrypt/Argon2 + salt
- 通信の暗号化（HTTPS必須）

### 7. セキュリティ設定ミス（Security Misconfiguration）
- バージョン情報の漏洩（Apache/PHP版数）
- デフォルトパスワード、デバッグモードON
- コードは局所的な穴、設定ミスは穴の開示+穴そのものにもなる

### 8. 脆弱なコンポーネント（Vulnerable Components）
- 依存関係の増加によるリスク
- Log4Shell（2021年）: CVSS 10.0、世界規模の影響
- 対策: SBOM、自動スキャン、最小依存の原則
- 便利さとセキュリティの著しいトレードオフ

### 9. 認証の失敗（Identification and Authentication Failures）
- セッションハイジャック → アカウント乗っ取りへの発展
- セッションIDの要件: 128bit以上、暗号論的乱数、HTTPS必須
- 重要操作には再認証を要求（パスワード変更、MFA変更等）
- 通常操作と重要操作の権限を分離

### 10. ログと監視の失敗（Security Logging and Monitoring Failures）
- ログの3つの役割: 検知、追跡、抑止
- 記録すべきイベント: 認証系、権限系、異常系
- リモートログサーバーで証拠隠滅を防止（Phase 1で学習済み）

## 核心原理：OWASP Top 10 完全版

**すべての脆弱性は「分離の欠如」に起因する**

| # | 脆弱性 | 分離すべきもの |
|---|--------|--------------|
| 1 | SQLi | コード / データ |
| 2 | XSS | コード / データ |
| 3 | IDOR | ユーザー / 権限 |
| 4 | CSRF | 認証 / 操作の正当性 |
| 5 | SSRF | 外部 / 内部リソース |
| 6 | 暗号化の失敗 | 平文 / 暗号化データ |
| 7 | 設定ミス | 開発 / 本番設定 |
| 8 | 脆弱なコンポーネント | 信頼コード / 外部依存 |
| 9 | 認証の失敗 | 通常操作 / 重要操作 |
| 10 | ログ監視の失敗 | 発生 / 記録・検知 |

## Phase 1との接続

- Phase 1: 構造で分離（passwd/shadow、ハイブリッド暗号）
- Phase 2: 信頼境界で分離（データ/コード、ユーザー/権限）

セキュリティの本質は「混ぜてはいけないものを構造的に分ける」こと。

## 次のステップ

- Phase 2残り: SQLインジェクション深掘り、XSS深掘り、認証・認可深掘り
- 実践演習: PortSwigger Web Security Academy
- Phase 3: クラウド・コンテナセキュリティ
