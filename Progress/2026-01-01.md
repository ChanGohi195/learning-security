# 2026-01-01 学習ログ

## 今日やったこと

- ネットワークセキュリティ基礎（Phase 1）
  - パケット通信の仕組み
  - TCP vs UDP
  - 3ウェイハンドシェイク
  - SYN Flood攻撃と防御策
  - SYN Cookieの仕組み

## 学んだこと

### 1. パケット通信の基本

**なぜパケット化するのか**
- データを細切れにすることで、一度の不具合で全情報を喪失するリスクを極小化
- シーケンス番号（配列情報）を振ることで順序管理と復元を可能にする
- 部分的な再送により効率的な通信を実現

**キーワード**
- パケット: データの単位
- シーケンス番号: 順序管理
- OS: パケット処理を担当（SSHはプロトコル、HTMLはマークアップ言語）

### 2. TCP vs UDP

| プロトコル | 特徴 | 用途 |
|-----------|------|------|
| TCP | 確実（番号、確認、再送） | 信頼性が必要な通信（Web、メール） |
| UDP | 高速（確認なし、再送なし） | リアルタイム性が必要な通信（動画、VoIP） |

### 3. 3ウェイハンドシェイク

**接続確立の流れ**
```
クライアント    サーバー
    SYN    →
           ←   SYN+ACK
    ACK    →
    （接続確立）
```

**脆弱性**: ハーフオープン状態を悪用可能

### 4. SYN Flood攻撃

**攻撃の仕組み**
- SYNパケットを大量送信
- サーバーはSYN+ACKを返して待機状態（ハーフオープン）
- ACKを返さず、サーバーの待機リソースを枯渇させる
- 結果: 正規ユーザーが接続できなくなる（DoS）

**類似攻撃**: F5アタック（リロード連打によるリソース枯渇）

### 5. 防御策

| 防御手法 | 仕組み |
|---------|--------|
| レート制限 | 統計的特徴を超えるリクエストを遮断 |
| IPブラックリスト | 攻撃元IPを遮断 |
| 異常検知 | 通常パターンからの逸脱を検出 |
| **SYN Cookie** | **状態を持たずに接続を検証** |

**SYN Cookieの仕組み**
- サーバーは待機状態を作らない
- SYN+ACKに秘密鍵を使った計算値を含める
- ACKが返ってきたら、秘密鍵で検証
- 正当な値でなければ接続を拒否

**重要**: アドレスは最初からわかっている。秘密鍵がないと正しい値を計算できないのがポイント。

### 6. 暗号の入り口

SYN Cookieで秘密鍵を使った検証を行うことで、暗号の基礎概念に触れた。

## 詰まったこと

### 誤答から学んだこと

1. **パケット処理を担当するのは「OS」**
   - 誤答: SSH
   - 学び: SSHは暗号化通信プロトコル。OSがネットワークスタックを担当

2. **通信のルールは「プロトコル」**
   - 誤答: HTML
   - 学び: HTMLはマークアップ言語。通信ルール=プロトコル（TCP/UDP等）

3. **SYN Cookieの検証は「秘密鍵」**
   - 誤答: アドレスの開示を要求
   - 学び: アドレスは最初からわかっている。秘密鍵による計算と照合で検証

---

## 追加学習（後半）

### 7. IPアドレスとネットワーク構成要素

**建物の住所としてのIPアドレス**
- IPアドレス: 通信先を特定する識別子（建物の住所）
- サブネットマスク: 直接通信できる範囲を規定（ご近所の定義）
- ルーター/ゲートウェイ: 外部への窓口（郵便局）
- DNS: 名前から住所を調べる電話帳

### 8. DNS攻撃と防御

**DNS攻撃の種類**
- **DNSスプーフィング**: 偽のIPアドレスを返す攻撃
- **DNSポイズニング**: キャッシュを汚染する攻撃

**防御策**
- HTTPS/TLS証明書による通信先の検証
- DNSSEC（DNS Security Extensions）

### 9. HTTPSの2つの役割

| 役割 | 内容 |
|------|------|
| 暗号化 | 通信内容を見られないようにする |
| 認証 | 接続先が本物か確認する |

**重要**: 「鍵マークがあれば安全」は誤解。ドメイン自体の確認が必要。

### 10. ポート

**ポート = 建物内の部屋番号**
- IPアドレス = 建物の住所
- ポート = 部屋番号（サービスの区別）

**主要ポート番号**
- 80: HTTP
- 443: HTTPS
- 22: SSH
- 25: SMTP（メール送信）
- 53: DNS

**ポートスキャン**: 開いている部屋（ポート）を調べる攻撃の初手

### 11. ファイアウォール

**役割**: 通信の許可/拒否を制御

**DROP vs REJECT**
| 動作 | 説明 | セキュリティ評価 |
|------|------|-----------------|
| DROP | 無視（応答しない） | 推奨（情報を与えない） |
| REJECT | 拒否通知を返す | 存在を教えてしまう |

**原則**: 「存在しないかのように振る舞う」

### ネットワーク基礎 完了まとめ

| トピック | 内容 | セキュリティ観点 |
|----------|------|-----------------|
| パケット | データを細切れで送る | - |
| TCP/UDP | 確実 vs 高速 | SYN Flood攻撃 |
| IPアドレス | 通信先の特定 | IPスプーフィング |
| DNS | 名前→IP変換 | DNSスプーフィング |
| HTTPS | 暗号化 + 認証 | フィッシング対策 |
| ポート | サービスの区別 | ポートスキャン |
| ファイアウォール | 通信制御 | DROP vs REJECT |

## 詰まったこと（追加）

### 理解が深まった点

1. **サブネットマスクの役割**
   - 正しい理解: 直接渡す範囲を規定している
   - 評価: 正確な理解

2. **名前とアドレスの検証**
   - 発想: 暗号鍵で結びつけて、正しく変換されないなら信頼しない
   - 評価: TLS証明書の概念を独力で導出

3. **ポートの概念**
   - 比喩: 集合住宅の部屋番号
   - 評価: 完璧な類似

4. **ポートスキャン対策**
   - 発想: ダミーを送り続けて撹乱
   - 評価: ハニーポットの発想に近い

5. **DROP vs REJECT**
   - 理解: 情報を与えないことが重要
   - 評価: セキュリティの基本原則を理解

## 明日やること

### 次のステップ（優先順位順）

1. **Phase 1: Linux セキュリティ or 暗号基礎**
   - ネットワーク基礎は完了
   - Linux権限管理、ファイルシステム
   - または暗号の基礎理論へ

2. **実践課題への着手**
   - nmapでポートスキャン体験（許可された環境で）
   - Wiresharkでパケットキャプチャ

### 実践課題

- [ ] TryHackMe: Network Fundamentals ルームを試す
- [ ] Wiresharkで実際のTCP handshakeを観察
- [ ] SYN Flood攻撃のラボ環境を構築（自環境のみ）

## 理解度（自己評価）

- [x] 攻撃を説明できる（SYN Flood攻撃の仕組みを理解）
- [x] 防御を説明できる（SYN Cookie含む防御策を理解）
- [ ] 実践できる（まだラボ環境での実践はこれから）

## ユーザーの良い発想（記録）

| 場面 | 発想 | 評価 |
|------|------|------|
| ネットワークの基本イメージ | 郵便のメタファー（手紙=信号、住所=アドレス、封=暗号化） | 正確な直感 |
| なぜ細切れにするか | 一度の不具合で全情報喪失リスクを極小化、復元も楽 | 本質を捉えている |
| 順序管理 | ページ番号を振る（配列情報を渡す） | シーケンス番号の概念を独力で導出 |
| TCPの脆弱性悪用 | アドレスを書き換えて偽ACKを返し続ける | 攻撃者視点で考えられている |
| SYN Flood | サーバ側の待機負荷を増大させ続ける、F5アタックとの類似 | 本質を正確に把握 |
| 防御策 | 統計的特徴を超えるリクエストを遮断 | レート制限・異常検知の発想 |
| サブネットマスクの役割 | 直接渡す範囲を規定している | 正確な理解 |
| 名前とアドレスの検証 | 暗号鍵で結びつけて正しく変換されないなら信頼しない | TLS証明書の概念を独力で導出 |
| ポートの概念 | 集合住宅の部屋番号 | 完璧な類似 |
| ポートスキャン対策 | ダミーを送り続けて撹乱 | ハニーポットの発想に近い |
| DROP vs REJECT | 情報を与えないことが重要 | セキュリティの基本原則を理解 |

## 関連リソース

- [[Concepts/]] - 今後、SYN Flood、SYN Cookie等の詳細を追加
- [[Practice/]] - TryHackMe、Wiresharkの実践記録を追加予定

---

#security #network #phase1 #tcp #syn-flood
