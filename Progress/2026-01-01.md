# 2026-01-01 学習ログ

## 今日やったこと

- ネットワークセキュリティ基礎（Phase 1）
  - パケット通信の仕組み
  - TCP vs UDP
  - 3ウェイハンドシェイク
  - SYN Flood攻撃と防御策
  - SYN Cookieの仕組み

## 学んだこと

### 1. パケット通信の基本

**なぜパケット化するのか**
- データを細切れにすることで、一度の不具合で全情報を喪失するリスクを極小化
- シーケンス番号（配列情報）を振ることで順序管理と復元を可能にする
- 部分的な再送により効率的な通信を実現

**キーワード**
- パケット: データの単位
- シーケンス番号: 順序管理
- OS: パケット処理を担当（SSHはプロトコル、HTMLはマークアップ言語）

### 2. TCP vs UDP

| プロトコル | 特徴 | 用途 |
|-----------|------|------|
| TCP | 確実（番号、確認、再送） | 信頼性が必要な通信（Web、メール） |
| UDP | 高速（確認なし、再送なし） | リアルタイム性が必要な通信（動画、VoIP） |

### 3. 3ウェイハンドシェイク

**接続確立の流れ**
```
クライアント    サーバー
    SYN    →
           ←   SYN+ACK
    ACK    →
    （接続確立）
```

**脆弱性**: ハーフオープン状態を悪用可能

### 4. SYN Flood攻撃

**攻撃の仕組み**
- SYNパケットを大量送信
- サーバーはSYN+ACKを返して待機状態（ハーフオープン）
- ACKを返さず、サーバーの待機リソースを枯渇させる
- 結果: 正規ユーザーが接続できなくなる（DoS）

**類似攻撃**: F5アタック（リロード連打によるリソース枯渇）

### 5. 防御策

| 防御手法 | 仕組み |
|---------|--------|
| レート制限 | 統計的特徴を超えるリクエストを遮断 |
| IPブラックリスト | 攻撃元IPを遮断 |
| 異常検知 | 通常パターンからの逸脱を検出 |
| **SYN Cookie** | **状態を持たずに接続を検証** |

**SYN Cookieの仕組み**
- サーバーは待機状態を作らない
- SYN+ACKに秘密鍵を使った計算値を含める
- ACKが返ってきたら、秘密鍵で検証
- 正当な値でなければ接続を拒否

**重要**: アドレスは最初からわかっている。秘密鍵がないと正しい値を計算できないのがポイント。

### 6. 暗号の入り口

SYN Cookieで秘密鍵を使った検証を行うことで、暗号の基礎概念に触れた。

## 詰まったこと

### 誤答から学んだこと

1. **パケット処理を担当するのは「OS」**
   - 誤答: SSH
   - 学び: SSHは暗号化通信プロトコル。OSがネットワークスタックを担当

2. **通信のルールは「プロトコル」**
   - 誤答: HTML
   - 学び: HTMLはマークアップ言語。通信ルール=プロトコル（TCP/UDP等）

3. **SYN Cookieの検証は「秘密鍵」**
   - 誤答: アドレスの開示を要求
   - 学び: アドレスは最初からわかっている。秘密鍵による計算と照合で検証

## 明日やること

### 次のステップ（優先順位順）

1. **ネットワーク基礎の続き**
   - IPアドレスとサブネット
   - ポート番号の役割
   - ファイアウォールの基本

2. **または暗号基礎への深掘り**
   - 秘密鍵と公開鍵
   - ハッシュ関数
   - デジタル署名

### 実践課題

- [ ] TryHackMe: Network Fundamentals ルームを試す
- [ ] Wiresharkで実際のTCP handshakeを観察
- [ ] SYN Flood攻撃のラボ環境を構築（自環境のみ）

## 理解度（自己評価）

- [x] 攻撃を説明できる（SYN Flood攻撃の仕組みを理解）
- [x] 防御を説明できる（SYN Cookie含む防御策を理解）
- [ ] 実践できる（まだラボ環境での実践はこれから）

## ユーザーの良い発想（記録）

| 場面 | 発想 | 評価 |
|------|------|------|
| ネットワークの基本イメージ | 郵便のメタファー（手紙=信号、住所=アドレス、封=暗号化） | 正確な直感 |
| なぜ細切れにするか | 一度の不具合で全情報喪失リスクを極小化、復元も楽 | 本質を捉えている |
| 順序管理 | ページ番号を振る（配列情報を渡す） | シーケンス番号の概念を独力で導出 |
| TCPの脆弱性悪用 | アドレスを書き換えて偽ACKを返し続ける | 攻撃者視点で考えられている |
| SYN Flood | サーバ側の待機負荷を増大させ続ける、F5アタックとの類似 | 本質を正確に把握 |
| 防御策 | 統計的特徴を超えるリクエストを遮断 | レート制限・異常検知の発想 |

## 関連リソース

- [[Concepts/]] - 今後、SYN Flood、SYN Cookie等の詳細を追加
- [[Practice/]] - TryHackMe、Wiresharkの実践記録を追加予定

---

#security #network #phase1 #tcp #syn-flood
